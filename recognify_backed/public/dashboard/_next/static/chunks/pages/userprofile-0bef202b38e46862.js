(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[696],{7686:function(e,a,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/userprofile",function(){return l(5191)}])},5191:function(e,a,l){"use strict";l.r(a),l.d(a,{default:function(){return f}});var s=l(5893),r=l(7294),n=l(3680),o=l(3408),i=l(2175),t=l(6310),m=l(9473),d=l(1163),c=l(5675),u=l.n(c),p=l(5292),h=l(1800),x=l(4779),v=l(1192),N=l(9471),f=()=>{let e=(0,d.useRouter)(),a=(0,m.I0)(),[l,c]=(0,r.useState)(""),[f,j]=(0,r.useState)(null);(0,m.v9)(e=>{var a,l;return null===(l=e.login)||void 0===l?void 0:null===(a=l.userToken)||void 0===a?void 0:a.token});let b=(0,m.v9)(e=>{var a,l;return null===(l=e.login)||void 0===l?void 0:null===(a=l.userToken)||void 0===a?void 0:a.user_id}),g=(0,m.v9)(e=>{var a;return null===(a=e.login)||void 0===a?void 0:a.userToken}),_=e=>{var a;(null==e?void 0:e.target.files)&&(null==e?void 0:null===(a=e.target.files)||void 0===a?void 0:a.length)>0&&(j(e.target.files[0]),w(e.target.files[0]).then(e=>{c(e)}))},w=e=>new Promise((a,l)=>{let s=new FileReader;s.readAsDataURL(e),s.onload=()=>{var e;return a((null===(e=s.result)||void 0===e?void 0:e.toString())||"")},s.onerror=e=>l(e)}),y={image:(null==g?void 0:g.image)||"",oldImage:(null==g?void 0:g.oldImage)||"",first_name:(null==g?void 0:g.first_name)||"",last_name:(null==g?void 0:g.last_name)||"",password:"",email:(null==g?void 0:g.email)||"",role:(null==g?void 0:g.role)||"",address:(null==g?void 0:g.address)||"",phone_number:(null==g?void 0:g.phone_number)||"",company_name:(null==g?void 0:g.company_name)||""},Z=window.innerWidth>=1200&&window.innerWidth<1400,I=()=>{e.back()};return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"card",children:(0,s.jsx)("div",{className:"card-datatable ".concat(Z?"table-responsive-xl":"table-responsive-xxl"),children:(0,s.jsxs)("div",{className:"dataTables_wrapper dt-bootstrap5",children:[(0,s.jsxs)("div",{className:"card-header flex-column flex-md-row d-flex justify-content-between align-items-center mb-3",children:[(0,s.jsx)("h4",{className:"col-md-6 mb-2 mb-md-0",children:"User Profile"}),(0,s.jsx)("div",{className:"btn-close p-2",onClick:()=>I()})]}),(0,s.jsx)("div",{className:"row w-100 m-auto",children:(0,s.jsx)(i.J9,{enableReinitialize:!0,initialValues:y,validationSchema:t.Ry().shape({first_name:t.Z_().matches(/^[a-zA-Z]+$/,"Invalid name format").required("First Name is required").min(2,"First Name must be at least 2 characters").max(30,"First Name can be at most 30 characters"),last_name:t.Z_().matches(/^[a-zA-Z]+$/,"Invalid Last Name format").required("Last Name is required").min(2,"Last Name must be at least 2 characters").max(30,"Last Name can be at most 30 characters"),email:t.Z_().required("Email is required").email("Invalid email format").max(100,"Email can be at most 100 characters"),role:t.Z_().required("Role is required"),address:t.Z_().required("Address is required").min(8,"Address must be at least 8 characters").max(100,"Address Name can be at most 100 characters"),phone_number:t.Z_().required("Phone Number is required").min(10,"Phone Number must be at least 10 digits").max(10,"Phone Number can be at most 10 digits").matches(/^[0-9]+$/,"Phone Number must contain only digits"),password:t.Z_().min(8,"Password must be at least 8 characters").max(15,"Password can be at most 15 characters").notRequired()}),onSubmit:async l=>{a((0,p.N)(!0));try{if(f&&f.size>1048576){(0,h.ZP)(h.N3,"Image size should not exceed 1 MB."),a((0,p.N)(!1));return}let r=new FormData;f&&(r.append("image",f||l.image),r.append("oldImage",l.oldImage.trim())),r.append("first_name",l.first_name.trim()),r.append("last_name",l.last_name.trim()),""!==l.password.trim()&&r.append("password",l.password.trim()),r.append("email",l.email.trim()),r.append("role",l.role.toString()),r.append("address",l.address.trim()),r.append("phone_number",l.phone_number.trim()),r.append("company_name",l.company_name.trim());let n=await x.Z.put("user/update",r,b,!0);if(200==n.status){var s;console.log(null==n?void 0:n.data),a((0,p.N)(!1)),a((0,v.d)(!0)),a((0,N.o4)(null==n?void 0:null===(s=n.data)||void 0===s?void 0:s.jwtToken)),null==e||e.back(),c(""),j(null)}}catch(e){a((0,p.N)(!1))}finally{a((0,p.N)(!1))}},children:e=>{let{values:a,handleSubmit:r}=e;return(0,s.jsxs)(o.Z,{onSubmit:r,children:[(0,s.jsxs)("div",{className:"row",children:[(0,s.jsxs)("div",{className:"col-md-6 col-sm-12",children:[(0,s.jsxs)(o.Z.Label,{className:"d-flex flex-column align-items-center",children:[(0,s.jsx)("h5",{style:{marginBottom:"10px",fontWeight:"bold"},children:"Upload user image"}),(0,s.jsx)("small",{style:{color:"gray"},children:"Supported formats: JPG, PNG, JPEG / Max file size is 1MB"})]}),(0,s.jsxs)("div",{className:"avatar-upload mb-3",children:[(0,s.jsxs)("div",{className:"avatar-edit",children:[(0,s.jsx)("input",{type:"file",id:"imageUpload",accept:".png, .jpg, .jpeg",onChange:e=>_(e)}),(0,s.jsx)("label",{htmlFor:"imageUpload"})]}),(0,s.jsx)("div",{className:"avatar-preview",children:l||(null==g?void 0:g.image)?(0,s.jsx)(u(),{src:l||(null==g?void 0:g.image)||"/recognify/react/img/profile.png",alt:"Profile Image",width:192,height:192,quality:100,style:{position:"relative",borderRadius:"100%",objectFit:"cover",border:"6px solid #F8F8F8",boxShadow:" 0px 2px 4px 0px rgba(0, 0, 0, 0.1)"}}):(0,s.jsx)("div",{className:"upload-placeholder"})})]})]}),(0,s.jsxs)("div",{className:"col-md-6 col-sm-12",children:[(0,s.jsxs)(o.Z.Group,{controlId:"first_name",children:[(0,s.jsx)(o.Z.Label,{className:"form-control-label",children:(0,s.jsx)("h6",{children:"First Name"})}),(0,s.jsx)(i.gN,{type:"text",className:"form-control-alternative form-control field-input",name:"first_name",autoComplete:"off",placeholder:"First Name"}),(0,s.jsx)(i.Bc,{name:"first_name",component:"span",className:"error-message"})]}),(0,s.jsxs)(o.Z.Group,{controlId:"last_name",children:[(0,s.jsx)(o.Z.Label,{className:"form-control-label",children:(0,s.jsx)("h6",{children:"Last Name"})}),(0,s.jsx)(i.gN,{type:"text",className:"form-control-alternative form-control field-input",name:"last_name",autoComplete:"off",placeholder:"Last Name"}),(0,s.jsx)(i.Bc,{name:"last_name",component:"span",className:"error-message"})]}),(0,s.jsxs)(o.Z.Group,{controlId:"email",children:[(0,s.jsx)(o.Z.Label,{className:"form-control-label",children:(0,s.jsx)("h6",{children:"Email"})}),(0,s.jsx)(i.gN,{type:"email",className:"form-control-alternative form-control field-input",name:"email",disabled:!0,autoComplete:"off",placeholder:"Email"}),(0,s.jsx)(i.Bc,{name:"email",component:"span",className:"error-message"})]})]})]}),(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("div",{className:"col-md-6",children:(0,s.jsxs)(o.Z.Group,{controlId:"role",children:[(0,s.jsx)(o.Z.Label,{className:"form-control-label",children:(0,s.jsx)("h6",{children:"Role"})}),(0,s.jsxs)(i.gN,{as:"select",className:"form-control-alternative form-control field-input",name:"role",disabled:!0,children:[(0,s.jsx)("option",{hidden:!0,value:"",children:"Select a role"}),(0,s.jsx)("option",{value:1,children:"Admin"}),(0,s.jsx)("option",{value:2,children:"Customer"}),(0,s.jsx)("option",{value:3,children:"Supplier"})]}),(0,s.jsx)(i.Bc,{name:"role",component:"span",className:"error-message"})]})}),(0,s.jsx)("div",{className:"col-md-6",children:(0,s.jsxs)(o.Z.Group,{controlId:"phone_number",children:[(0,s.jsx)(o.Z.Label,{className:"form-control-label",children:(0,s.jsx)("h6",{children:"Phone Number"})}),(0,s.jsx)(i.gN,{type:"phone",className:"form-control-alternative form-control field-input",name:"phone_number",autoComplete:"off",placeholder:"Phone Number"}),(0,s.jsx)(i.Bc,{name:"phone_number",component:"span",className:"error-message"})]})})]}),(0,s.jsx)("div",{className:"row",children:(0,s.jsx)("div",{className:"col-md-6",children:(0,s.jsxs)(o.Z.Group,{controlId:"company_name",children:[(0,s.jsx)(o.Z.Label,{className:"form-control-label",children:(0,s.jsx)("h6",{children:"Company Name"})}),(0,s.jsx)(i.gN,{type:"text",className:"form-control-alternative form-control field-input",name:"company_name",autoComplete:"off",placeholder:"Company Name"})]})})}),(0,s.jsx)("div",{className:"row",children:(0,s.jsx)("div",{className:"col-md-12",children:(0,s.jsxs)(o.Z.Group,{controlId:"address",children:[(0,s.jsx)(o.Z.Label,{className:"form-control-label",children:(0,s.jsx)("h6",{children:"Address"})}),(0,s.jsx)(i.gN,{as:"textarea",className:"form-control-alternative form-control field-input",name:"address",autoComplete:"off",rows:4,placeholder:"Address"}),(0,s.jsx)(i.Bc,{name:"address",component:"span",className:"error-message"})]})})}),(0,s.jsx)("div",{className:"row mt-4",children:(0,s.jsx)("div",{className:"col-md-12 m-auto text-center",children:(0,s.jsx)(n.Z,{className:"btn btn-primary w-25",type:"submit",children:"Update"})})})]})}})})]})})})})}}},function(e){e.O(0,[743,304,774,888,179],function(){return e(e.s=7686)}),_N_E=e.O()}]);